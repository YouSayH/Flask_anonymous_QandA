<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>質問詳細 - 匿名Q&Aボード</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body>
  <header>
    <div class="back-link">
      <a href="{{ url_for('main.index') }}">← 戻る</a>
    </div>
    <div class="header-text">
      <h1>質問詳細</h1>
      {% if session.get('st_num') %}
      <div class="user-info">
        学籍番号: {{ session.get('st_num') }}
      </div>
      {% endif %}
    </div>
    {% if session.get('st_num') %}
    <div class="logout-button">
      <a href="{{ url_for('main.logout') }}">ログアウト</a>
    </div>
    {% endif %}
  </header>

  <main>
    <!-- 質問内容表示 -->
    <div class="question-container">
      <article class="question-detail">
        <h2 class="question-title">{{ question['question_content'] | e }}</h2>
        <p class="timestamp">投稿日時: {{ question['created_at'] }}</p>
      </article>

      <!-- 回答一覧 -->
      <form method="POST" action="{{ url_for('main.select_best', question_id=question['id']) }}">
        <section id="answers-list">
          <h3>回答一覧</h3>
          <ul>
            {% for answer in answers %}
            <li>
              <input type="radio" name="best_answer" value="{{ answer['id'] }}" {% if
                question['best_answer_id']==answer['id'] %} checked {% endif %}>
              {% if question['best_answer_id'] == answer['id'] %}
              <span class="best-answer-badge">🏅 ベストアンサー</span>
              {% endif %}
              <p class="answer-content">{{ answer['answer_content'] | e }}</p>
              <span class="timestamp">{{ answer['created_at'] }}</span>
            </li>
            {% else %}
            <li>まだ回答がありません。</li>
            {% endfor %}
          </ul>
        </section>
        <button type="submit">ベストアンサーを決定する</button>
      </form>


      <!-- 回答投稿フォーム -->
      <section id="post-answer">
        <h3>回答を投稿する</h3>
        <form action="{{ url_for('main.answer', question_id=question['id']) }}" method="POST">
          <div class="post-answer-form">
            <textarea name="answer" rows="4" placeholder="回答内容を入力してください" required></textarea>
            <button type="submit" class="post-answer-button">回答を投稿する</button>
          </div>
        </form>
      </section>
    </div>
  </main>
</body>

</html>